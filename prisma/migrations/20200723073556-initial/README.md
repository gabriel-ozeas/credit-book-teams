# Migration `20200723073556-initial`

This migration has been generated by JamesJ at 7/23/2020, 7:35:56 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "public"."Session" (
"accessToken" text  NOT NULL ,
"accessTokenExpires" timestamp(3)   ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"expires" timestamp(3)   ,
"id" text  NOT NULL ,
"sessionToken" text  NOT NULL ,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Account" (
"accessToken" text   ,
"accessTokenExpires" timestamp(3)   ,
"compoundId" text  NOT NULL ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"id" text  NOT NULL ,
"providerAccountId" text  NOT NULL ,
"providerId" text  NOT NULL ,
"providerType" text  NOT NULL ,
"refreshToken" text   ,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"userId" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."VerificationRequest" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"expires" timestamp(3)  NOT NULL ,
"id" text  NOT NULL ,
"identifier" text  NOT NULL ,
"token" text  NOT NULL ,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."User" (
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"email" text   ,
"emailVerified" timestamp(3)   ,
"id" text  NOT NULL ,
"image" text   ,
"name" text   ,
"updatedAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."Team" (
"id" text  NOT NULL ,
"joinAttempts" integer   ,
"joinCode" text   ,
"joinCodeExpiration" timestamp(3)   ,
"teamName" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."UserTeam" (
"role" text  NOT NULL ,
"teamId" text  NOT NULL ,
"userId" text  NOT NULL ,
    PRIMARY KEY ("teamId","userId"))

CREATE TABLE "public"."Credit" (
"claimedAt" timestamp(3)   ,
"claimedById" text   ,
"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,
"createdById" text   ,
"dollarValue" integer   ,
"id" text  NOT NULL ,
"itemValue" text   ,
"name" text   ,
"phone" text   ,
"reason" text   ,
"teamId" text  NOT NULL ,
"updatedAt" timestamp(3)   ,
"updatedById" text   ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "Session.accessToken" ON "public"."Session"("accessToken")

CREATE UNIQUE INDEX "Session.sessionToken" ON "public"."Session"("sessionToken")

CREATE UNIQUE INDEX "Account.compoundId" ON "public"."Account"("compoundId")

CREATE UNIQUE INDEX "Account.providerAccountId" ON "public"."Account"("providerAccountId")

CREATE UNIQUE INDEX "VerificationRequest.token" ON "public"."VerificationRequest"("token")

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "Team.joinCode" ON "public"."Team"("joinCode")

ALTER TABLE "public"."Session" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Account" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."UserTeam" ADD FOREIGN KEY ("teamId")REFERENCES "public"."Team"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."UserTeam" ADD FOREIGN KEY ("userId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Credit" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Credit" ADD FOREIGN KEY ("claimedById")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Credit" ADD FOREIGN KEY ("createdById")REFERENCES "public"."User"("id") ON DELETE SET NULL  ON UPDATE CASCADE

ALTER TABLE "public"."Credit" ADD FOREIGN KEY ("teamId")REFERENCES "public"."Team"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200723073556-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,103 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model Session {
+  id                 String    @default(uuid()) @id
+  userId             String
+  user               User      @relation(fields: [userId], references: [id])
+  accessToken        String    @default(cuid()) @unique
+  sessionToken       String    @default(cuid()) @unique
+  accessTokenExpires DateTime?
+  expires            DateTime?
+  createdAt          DateTime  @default(now())
+  updatedAt          DateTime  @updatedAt @default(now())
+}
+
+model Account {
+  id                 String    @default(uuid()) @id
+  compoundId         String    @unique
+  userId             String
+  user               User      @relation(fields: [userId], references: [id])
+  providerId         String
+  providerType       String
+  providerAccountId  String    @unique
+  refreshToken       String?
+  accessToken        String?
+  accessTokenExpires DateTime?
+  createdAt          DateTime  @default(now())
+  updatedAt          DateTime  @updatedAt @default(now())
+}
+
+model VerificationRequest {
+  id         String   @default(uuid()) @id
+  identifier String
+  token      String   @unique
+  expires    DateTime
+  createdAt  DateTime @default(now())
+  updatedAt  DateTime @updatedAt @default(now())
+}
+
+model User {
+  id             String     @default(uuid()) @id
+  email          String?    @unique
+  emailVerified  DateTime?
+  image          String?
+  name           String?
+  sessions       Session[]
+  accounts       Account[]
+  createdAt      DateTime   @default(now())
+  updatedAt      DateTime   @updatedAt @default(now())
+  teams          UserTeam[]
+  claimedCredits Credit[]   @relation("ClaimedCredits")
+  createdCredits Credit[]   @relation("CreatedCredits")
+  updatedCredits Credit[]   @relation("UpdatedCredits")
+
+}
+
+model Team {
+  id                 String     @default(uuid()) @id
+  joinCode           String?    @unique
+  joinCodeExpiration DateTime?
+  joinAttempts       Int?
+  teamName           String
+  credits            Credit[]
+  users              UserTeam[]
+}
+
+model UserTeam {
+  role   String
+  teamId String
+  team   Team   @relation(fields: [teamId], references: [id])
+  userId String
+  user   User   @relation(fields: [userId], references: [id])
+
+  @@id([teamId, userId])
+
+}
+
+model Credit {
+  id            String    @default(uuid()) @id
+  createdAt     DateTime  @default(now())
+  createdById   String?
+  createdBy     User?     @relation("CreatedCredits", fields: [createdById], references: [id])
+  claimedAt     DateTime?
+  claimedById   String?
+  claimedBy     User?     @relation("ClaimedCredits", fields: [claimedById], references: [id])
+  updatedAt     DateTime?
+  updatedById   String?
+  updatedBy     User?     @relation("UpdatedCredits", fields: [createdById], references: [id])
+  dollarValue   Int?
+  itemValue     String?
+  name          String?
+  phone         String?
+  reason        String?
+  teamId        String
+  team          Team      @relation(fields: [teamId], references: [id])
+
+}
```


